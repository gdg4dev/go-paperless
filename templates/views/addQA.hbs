<!DOCTYPE html>
<html lang="en">
{{>dashHeader}}

<body>
    <link rel="stylesheet" href="/src/vendor/datatables.net-bs4/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" href="/src/vendor/datatables.net-buttons-bs4/css/buttons.bootstrap4.min.css">
    <link rel="stylesheet" href="/src/vendor/datatables.net-select-bs4/css/select.bootstrap4.min.css">
    {{>facultyDashSideNav}}
    <div class="container-fluid mt--4">
        <div class="row pt-3">

            <div class="col-lg-12">
                <div class="card-arapper">

                    <div class="card pt-5 pb-5"
                        style="display: flex;justify-content: center;text-align: center;align-items: center;">
                        <form action="" id="add-q-form" class="col-lg-12 col-md-12"
                            style="display: flex;justify-content: center;text-align: center;align-items: center; flex-direction:column"
                            method="post">
                            <h2>Add New Question</h2>
                            <div class="form-group col-lg-4">
                                <div data-toggle="quill" data-quill-placeholder="Enter Your Question Here"></div>
                            </div>
                            <div class="form-group col-lg-4">
                                <label for="exaName" class="form-control-label">Marks</label>
                                <input class="form-control" type="number" min="1" value="1" id="marks" required>
                            </div>
                            <input id="submit" class="btn btn-primary col-lg-4 p-b-3" type="submit"
                                value="Add Question">

                        </form>
                        <br><br>

                        <div class="table-responsive py-4">
                            <h3>Added Questions</h3>
                            <table class="table table-flush dataTable" id="datatable-buttons" role="grid"
                                aria-describedby="datatable-buttons_info">
                                <thead class="thead-light">
                                    <tr>
                                        <th>Question</th>
                                        <th>Marks</th>
                                    </tr>
                                </thead>
                                <tfoot>
                                    <tr>
                                        <th>Question</th>
                                        <th>Marks</th>
                                    </tr>
                                </tfoot>
                                <tbody id="tbd">

                                </tbody>
                            </table>
                        </div>


                    </div>
                </div>
            </div>
        </div>
        <div class="footer pt-0">
            <div class="row align-items-center justify-content-lg-between">
                <div class="col-lg-6">
                    <div class="copyright text-center  text-lg-left  text-muted">
                        Â© 2020 <a href="/" class="font-weight-bold ml-1" target="_blank">go-paperless</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="/src/js/common.js"></script>

    <script src="/src/vendor/jquery/dist/jquery.min.js"></script>
    <script src="/src/vendor/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/src/vendor/js-cookie/js.cookie.js"></script>
    <script src="/src/vendor/jquery.scrollbar/jquery.scrollbar.min.js"></script>
    <script src="/src/vendor/jquery-scroll-lock/dist/jquery-scrollLock.min.js"></script>
    <script src="/src/vendor/quill/dist/quill.min.js"></script>

    <script src="/src/vendor/datatables.net/js/jquery.dataTables.min.js"></script>
    <script src="/src/vendor/datatables.net-bs4/js/dataTables.bootstrap4.min.js"></script>
    <script src="/src/vendor/datatables.net-buttons/js/dataTables.buttons.min.js"></script>
    <script src="/src/vendor/datatables.net-buttons-bs4/js/buttons.bootstrap4.min.js"></script>
    <script src="/src/vendor/datatables.net-buttons/js/buttons.html5.min.js"></script>
    <script src="/src/vendor/datatables.net-buttons/js/buttons.flash.min.js"></script>
    <script src="/src/vendor/datatables.net-buttons/js/buttons.print.min.js"></script>
    <script src="/src/vendor/datatables.net-select/js/dataTables.select.min.js"></script>

    <script src="/src/js/argon.js"></script>
    <script src="/src/js/api.js"></script>
    <script>
        $('#exaStu').on('beforeItemAdd', (ev) => {
            if (/^[a-zA-Z,]+$/.test(ev.item)) {
                ev.cancel = true;
            }
        });
        $("#add-q-form").submit(e => e.preventDefault())

        $("#submit").click((e) => {
            ques = encodeURIComponent($('.ql-container.ql-snow')[0].children[0].children[0].innerHTML)
            marks = $('#marks').val()
            if (!(marks && ques)) return alert('ALL FIELDS ARE REQUIRED!')
            alert('processing')
            callAPI(JSON.stringify({
                actionCode: 10665,
                token: Cookies.get('token'),
                opt: {
                    question: {
                        ques,
                        marks
                    },
                     url: window.location.href
                }
            }), (cb) => {
                eval(cb.res)
                console.log(cb.res)
                a()
            })
        })

        callAPI(JSON.stringify({
            actionCode: 10690,
            token: Cookies.get('token'),
            opt: { url: window.location.href }
        }), (cb) => {
            dtable = $("#datatable-buttons").DataTable()
            console.log(cb)
            if (cb[0]) {
                cb.forEach((v, i) => {
                    dtable.row.add([
                        `<p>${decodeURIComponent(v.question)}</p>`,
                        v.marks,
                ])})
            } else {
                dtable.row.add([
                    'NO DATA',
                    'NO DATA'
                ])
            }
            $(".thead-light")[0].children[0].children[1].click()
        })
    </script>
</body>

</html>